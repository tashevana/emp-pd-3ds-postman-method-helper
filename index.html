<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>IPG 3DS Method Helper</title>
<style>
  #threedsIframe {
    width: 400px;
    height: 300px;
    border: 1px solid #ccc;
  }
  #threedsForm {
    display: none;
  }
</style>
</head>
<body>
  <h3>IPG 3DS Method Helper</h3>
  <p>This page submits <code>threeDSMethodData</code> to the ACS in an iframe for testing.</p>

  <iframe id="threedsIframe" name="threedsIframe"></iframe>

  <form id="threedsForm" method="post" target="threedsIframe" novalidate>
    <input type="hidden" name="threeDSMethodData" id="threeDSMethodData" />
  </form>

  <script>
    (function() {
      // Parse query parameters
      function getQueryParams() {
        const params = {};
        window.location.search.substring(1).split("&").forEach(pair => {
          const [key, value] = pair.split("=");
          if (key) params[decodeURIComponent(key)] = decodeURIComponent(value || "");
        });
        return params;
      }

      const params = getQueryParams();
      const form = document.getElementById("threedsForm");

      if (params.redirect_url && params.redirect_data) {
        // Set form action and hidden input
        form.action = params.redirect_url;
        document.getElementById("threeDSMethodData").value = params.redirect_data;

        // Submit form automatically
        form.submit();
        console.log("3DS Method submitted to", form.action);
      } else {
        document.body.innerHTML = "<h3>Error: Missing redirect_url or redirect_data</h3>";
      }
    })();
  </script>
</body>
</html>
