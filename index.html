<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>3DS Method Helper</title>
<style>
  /* Hidden iframe and form */
  #threeDSMethodIframe {
    /* display: none; */  /* Uncomment this line to hide the iframe after testing */
    width: 400px;
    height: 300px;
    border: 1px solid #ccc;
  }
  #threeDSMethodForm {
    display: none; /* Keep form hidden */
  }
</style>
</head>
<body>
  <iframe id="threeDSMethodIframe" name="threeDSMethodIframe"></iframe>

  <form
    id="threeDSMethodForm"
    method="post"
    target="threeDSMethodIframe"
    novalidate
  >
    <input type="hidden" name="unique_id" id="unique_id" />
    <input type="hidden" name="signature" id="signature" />
  </form>

  <script>
    // Helper to get URL query params
    function getQueryParams() {
      const params = {};
      window.location.search
        .substring(1)
        .split("&")
        .forEach(pair => {
          const [key, value] = pair.split("=");
          if (key) params[decodeURIComponent(key)] = decodeURIComponent(value || "");
        });
      return params;
    }

    // Main logic
    (function () {
      const params = getQueryParams();

      if (!params.threeds_method_url || !params.unique_id || !params.signature) {
        document.body.innerHTML = "<h3>Error: Missing required parameters</h3>";
        return;
      }

      // Set form action and input values
      const form = document.getElementById("threeDSMethodForm");
      form.action = params.threeds_method_url;
      document.getElementById("unique_id").value = params.unique_id;
      document.getElementById("signature").value = params.signature;

      // Submit form automatically
      form.submit();

      // Optionally, display a minimal message or keep blank since iframe is visible
      console.log("3DS Method form submitted to", params.threeds_method_url);
    })();
  </script>
</body>
</html>
