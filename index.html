<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>3DS Helper</title>
<style>
  /* Iframe and form styling */
  #threeDSHelperIframe {
    width: 100%;
    height: 600px;
    border: 1px solid #ccc;
  }
  #threeDSHelperForm {
    display: none; /* Keep form hidden */
  }
</style>
</head>
<body>
  <iframe id="threeDSHelperIframe" name="threeDSHelperIframe"></iframe>

  <form id="threeDSHelperForm" method="post" target="threeDSHelperIframe" novalidate>
    <input type="hidden" name="threeDSMethodData" id="threeDSMethodData" />
  </form>

  <script>
    // Parse URL query parameters
    function getQueryParams() {
      const params = {};
      window.location.search.substring(1).split("&").forEach(pair => {
        const [key, value] = pair.split("=");
        if (key) params[decodeURIComponent(key)] = decodeURIComponent(value || "");
      });
      return params;
    }

    (function() {
      const params = getQueryParams();
      const { redirect_url, redirect_data, redirect_type } = params;

      if (!redirect_url || !redirect_data || !redirect_type) {
        document.body.innerHTML = "<h3>Error: Missing required parameters</h3>";
        return;
      }

      // Set form action and input
      const form = document.getElementById("threeDSHelperForm");
      form.action = redirect_url;
      document.getElementById("threeDSMethodData").value = redirect_data;

      // Automatically submit the form
      form.submit();

      console.log(`3DS Helper submitted for type: ${redirect_type} to URL:`, redirect_url);
    })();
  </script>
</body>
</html>
